{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Details - Foodify</title>
    <link rel="stylesheet" href="{% static 'css/payments.css' %}">
</head>
<body>
    <div class="payment-container">
        <!-- Header -->
        <div class="payment-header">
            <h1>üìã Payment Details</h1>
            <p>Complete information for Transaction #{{ transaction.transaction_id }}</p>
        </div>

        <!-- Transaction Overview -->
        <div class="payment-card">
            <h3 style="margin-bottom: 20px;">Transaction Overview</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                <div>
                    <div class="text-muted" style="font-size: 0.875rem; margin-bottom: 4px;">Transaction ID</div>
                    <div class="transaction-id" style="font-weight: 600;">{{ transaction.transaction_id }}</div>
                </div>
                <div>
                    <div class="text-muted" style="font-size: 0.875rem; margin-bottom: 4px;">Order ID</div>
                    <div style="font-weight: 600;">#{{ transaction.order.id }}</div>
                </div>
                <div>
                    <div class="text-muted" style="font-size: 0.875rem; margin-bottom: 4px;">Amount</div>
                    <div class="amount">‚Çπ{{ transaction.amount }}</div>
                </div>
                <div>
                    <div class="text-muted" style="font-size: 0.875rem; margin-bottom: 4px;">Status</div>
                    <span class="status-badge status-{{ transaction.status }}">
                        {{ transaction.get_status_display }}
                    </span>
                </div>
                <div>
                    <div class="text-muted" style="font-size: 0.875rem; margin-bottom: 4px;">Payment Method</div>
                    <div style="font-weight: 600; text-transform: capitalize;">{{ transaction.payment_method }}</div>
                </div>
                <div>
                    <div class="text-muted" style="font-size: 0.875rem; margin-bottom: 4px;">Date & Time</div>
                    <div style="font-weight: 600;">{{ transaction.created_at|date:"d M Y, g:i A" }}</div>
                </div>
            </div>
        </div>

        <!-- Customer & Restaurant Information -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px;">
            <div class="payment-card">
                <h3 style="margin-bottom: 16px;">üë§ Customer Information</h3>
                <div style="margin-bottom: 10px;">
                    <div class="text-muted" style="font-size: 0.875rem;">Name</div>
                    <div style="font-weight: 600;">{{ transaction.customer.get_full_name|default:transaction.customer.username }}</div>
                </div>
                <div style="margin-bottom: 10px;">
                    <div class="text-muted" style="font-size: 0.875rem;">Email</div>
                    <div>{{ transaction.customer.email }}</div>
                </div>
                <div>
                    <div class="text-muted" style="font-size: 0.875rem;">Phone</div>
                    <div>{{ transaction.customer.profile.phone|default:"Not provided" }}</div>
                </div>
            </div>

            <div class="payment-card">
                <h3 style="margin-bottom: 16px;">üè™ Restaurant Information</h3>
                {% if transaction.restaurant %}
                <div style="margin-bottom: 10px;">
                    <div class="text-muted" style="font-size: 0.875rem;">Name</div>
                    <div style="font-weight: 600;">{{ transaction.restaurant.name }}</div>
                </div>
                <div style="margin-bottom: 10px;">
                    <div class="text-muted" style="font-size: 0.875rem;">Cuisine</div>
                    <div>{{ transaction.restaurant.cuisine }}</div>
                </div>
                <div>
                    <div class="text-muted" style="font-size: 0.875rem;">Location</div>
                    <div>{{ transaction.restaurant.location }}</div>
                </div>
                {% else %}
                <div class="text-muted">Restaurant information not available</div>
                {% endif %}
            </div>
        </div>

        <!-- Order Items -->
        <div class="payment-card">
            <h3 style="margin-bottom: 16px;">üçΩÔ∏è Order Items</h3>
            <table class="payment-table">
                <thead>
                    <tr>
                        <th>Item</th>
                        <th>Quantity</th>
                        <th>Price</th>
                        <th>Subtotal</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in order_items %}
                    <tr>
                        <td style="font-weight: 600;">{{ item.name }}</td>
                        <td>{{ item.quantity }}</td>
                        <td>‚Çπ{{ item.price }}</td>
                        <td class="amount">‚Çπ{{ item.subtotal }}</td>
                    </tr>
                    {% endfor %}
                    <tr style="border-top: 2px solid var(--border-color);">
                        <td colspan="3" style="text-align: right; font-weight: 600;">Subtotal:</td>
                        <td class="amount">‚Çπ{{ order.total_amount }}</td>
                    </tr>
                    <tr>
                        <td colspan="3" style="text-align: right; font-weight: 600;">Delivery Fee:</td>
                        <td class="amount">‚Çπ{{ order.delivery_fee }}</td>
                    </tr>
                    <tr>
                        <td colspan="3" style="text-align: right; font-weight: 600;">Tax:</td>
                        <td class="amount">‚Çπ{{ order.tax_amount }}</td>
                    </tr>
                    <tr style="background-color: var(--bg-light); border-top: 2px solid var(--border-color);">
                        <td colspan="3" style="text-align: right; font-weight: 700; font-size: 1.125rem;">Grand Total:</td>
                        <td style="font-weight: 700; font-size: 1.25rem; color: var(--success-color);">‚Çπ{{ order.grand_total }}</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Delivery Information -->
        <div class="payment-card">
            <h3 style="margin-bottom: 16px;">üìç Delivery Information</h3>
            <div class="text-muted" style="font-size: 0.875rem; margin-bottom: 4px;">Delivery Address</div>
            <div style="white-space: pre-line; line-height: 1.6;">{{ order.delivery_address }}</div>
        </div>

        <!-- Action Buttons -->
        <div class="btn-group">
            {% if is_owner %}
                <a href="{% url 'payments:owner_dashboard' %}" class="btn-secondary">‚Üê Back to Dashboard</a>
                <a href="{% url 'orders:owner_order_detail' order.id %}" class="btn-primary">View Order Details</a>
            {% else %}
                <a href="{% url 'payments:payment_history' %}" class="btn-secondary">‚Üê Back to History</a>
                <a href="{% url 'orders:order_detail' order.id %}" class="btn-primary">View Order Details</a>
            {% endif %}
        </div>
    </div>
</body>
</html>
